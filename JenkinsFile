pipeline {
    agent {
        label "master"
    }
	


    stages {
        stage('CHECKOUT') {
            steps {
                echo 'We are running git clone command ...'
				script {
                    git 'https://github.com/iswa25/CI-exam.git';
                }
            }
        }
		 

		
		stage('BUILD') {
            steps {
                echo 'We are using Windows batch to build our maven project in order to install the package into the local repo /.m2...'
				script{
					bat "mvn clean install"
				
				}
            }
        }
		
        stage('TEST') {
            steps {
                echo 'We are testing to run tests using Windows batch also...'
				script{
					bat "mvn test"
				
				}
            }
        }
      
		
	 stage('Email Notification') {
          steps {
            mail bcc: '', body: '''Hi ArcTic your project Build is done..
            Jenkins.''', cc: '', from: '', replyTo: '', subject: 'SUCCESS', to: 'benbrahimwala18@gmail.com'
          }
        
        }
		
    }
    
    post {
        always {
            echo 'I will always say Hello again!'
            
	     
             	emailext body: "${currentBuild.currentResult}: Job ${env.JOB_NAME} build ${env.BUILD_NUMBER}\n More info at: ${env.BUILD_URL}",
                recipientProviders: [[$class: 'DevelopersRecipientProvider'], [$class: 'RequesterRecipientProvider']],
                subject: "Jenkins Build ${currentBuild.currentResult}: Job ${env.JOB_NAME}"
            
        }
    }
}
